<style>
    .theming_widget {
        background-color: hsl(var(--background-h), var(--background-s), var(--background-l), .8);
        border: 1px solid hsl(var(--text-h), var(--text-s), var(--text-l));
        border-radius: .1em;
        color: hsl(var(--text-h), var(--text-s), var(--text-l));
        bottom: 1em;
        padding: 1em;
        position: absolute;
        right: 1em;
        width: 40em;
    }
    .theming_widget .message { margin-bottom: 1em; }
    .theming_widget .option {
        align-items: center;
        display: flex;
        margin-bottom: 1em;
    }
    .theming_widget .option input { width: 30em; }
    .theming_widget .option .label { margin-left: 1em; }
    .theming_widget textarea {
        height: 10em;
        width: 100%;
    }
</style>
<div class="theming_widget"></div>
<script>
    const options = [
        {
            default: 0,
            key: 'hue',
            range: [0, 360],
            step: 1,
            tooltip: 'Primarily sets the hue of the link color (0-360 degrees)',
            value: HUE,
            variable: '--hue',
            unit: 'deg'
        },
        {
            default: 0,
            key: 'hue_spread',
            step: 1,
            tooltip: 'Applies additional hue variations if tint_back/tint_front is enabled (any number of degrees [+/-])',
            value: HUE_SPREAD,
            variable: '--hue-spread',
            unit: 'deg'
        },
        {
            default: 0,
            key: 'tint_back',
            range: [0, 100],
            step: 1,
            tooltip: 'Applies a color tint to the page background (0-100%)',
            value: TINT_BACK,
            variable: '--tint-back'
        },
        {
            default: 0,
            key: 'tint_front',
            range: [0, 100],
            step: 1,
            tooltip: 'Applies a color tint to the page foreground elements (0-100%)',
            value: TINT_FRONT,
            variable: '--tint-front'
        }
    ];
    
    const message = document.createElement('div');
    message.classList.add('message');

    const customizations = document.createElement('textarea');
    
    customizations.readOnly = true;
    
    const updateTextarea = () => {
        const customized = options.filter(option => option.value !== option.default);

        if (customized.length === 0) {
            customizations.innerHTML = '';
            message.innerHTML = 'No customizations made (all options are at their default currently).';
        } else {
            customizations.innerHTML = `# theme\n\n${customized.map(option => `${option.key}: ${option.value}`).join('\n')}`;
            message.innerHTML = 'Copy the customizations below to a manifest in your catalog';
        }
    };
    
    for (const option of options) {
        const { key, range, step, tooltip, unit, variable } = option;

        const input = document.createElement('input');
        
        if (range) {
            input.min = range[0];
            input.max = range[1];
        }
        
        input.step = step;
        input.title = tooltip;
        input.type = 'range';
        input.value = option.value;
        
        input.addEventListener('input', () => {
            option.value = input.valueAsNumber;
            document.querySelector(':root').style.setProperty(variable, unit ? `${option.value}${unit}` : option.value.toString());
            updateTextarea();
        });
        
        const span = document.createElement('span');
        
        span.classList.add('label');
        span.innerHTML = key;
        span.title = tooltip;
        
        const div = document.createElement('div');
        
        div.classList.add('option');
        div.appendChild(input);
        div.appendChild(span);
        
        document.querySelector('.theming_widget').appendChild(div);
    }
    
    document.querySelector('.theming_widget').appendChild(message);

    document.querySelector('.theming_widget').appendChild(customizations);

    updateTextarea();
</script>